!function(e,t,n){function r(e,t,n){return e.addEventListener?void e.addEventListener(t,n,!1):void e.attachEvent("on"+t,n)}function o(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return q[e.which]?q[e.which]:P[e.which]?P[e.which]:String.fromCharCode(e.which).toLowerCase()}function i(e,t){return e.sort().join(",")===t.sort().join(",")}function a(e){e=e||{};var t,n=!1;for(t in M)e[t]?n=!0:M[t]=0;n||(x=!1)}function c(e,t,n,r,o,a){var c,u,s=[],f=n.type;if(!N[e])return[];for("keyup"==f&&d(e)&&(t=[e]),c=0;c<N[e].length;++c)if(u=N[e][c],(r||!u.seq||M[u.seq]==u.level)&&f==u.action&&("keypress"==f&&!n.metaKey&&!n.ctrlKey||i(t,u.modifiers))){var l=!r&&u.combo==o,h=r&&u.seq==r&&u.level==a;(l||h)&&N[e].splice(c,1),s.push(u)}return s}function u(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function s(e){return e.preventDefault?void e.preventDefault():void(e.returnValue=!1)}function f(e){return e.stopPropagation?void e.stopPropagation():void(e.cancelBubble=!0)}function l(e,t,n,r){O.stopCallback(t,t.target||t.srcElement,n,r)||e(t,n)===!1&&(s(t),f(t))}function h(e,t,n){var r,o=c(e,t,n),i={},u=0,s=!1;for(r=0;r<o.length;++r)o[r].seq&&(u=Math.max(u,o[r].level));for(r=0;r<o.length;++r)if(o[r].seq){if(o[r].level!=u)continue;s=!0,i[o[r].seq]=1,l(o[r].callback,n,o[r].combo,o[r].seq)}else s||l(o[r].callback,n,o[r].combo);var f="keypress"==n.type&&j;n.type!=x||d(e)||f||a(i),j=s&&"keydown"==n.type}function p(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=o(e);if(t)return"keyup"==e.type&&S===t?void(S=!1):void O.handleKey(t,u(e),e)}function d(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function y(){clearTimeout(K),K=setTimeout(a,1e3)}function m(){if(!E){E={};for(var e in q)e>95&&112>e||q.hasOwnProperty(e)&&(E[q[e]]=e)}return E}function v(e,t,n){return n||(n=m()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function k(e,t,n,r){function i(t){return function(){x=t,++M[e],y()}}function c(t){l(n,t,e),"keyup"!==r&&(S=o(t)),setTimeout(a,10)}M[e]=0;for(var u=0;u<t.length;++u){var s=u+1===t.length,f=s?c:i(r||w(t[u+1]).action);b(t[u],f,r,e,u)}}function g(e){return"+"===e?["+"]:e.split("+")}function w(e,t){var n,r,o,i=[];for(n=g(e),o=0;o<n.length;++o)r=n[o],L[r]&&(r=L[r]),t&&"keypress"!=t&&T[r]&&(r=T[r],i.push("shift")),d(r)&&i.push(r);return t=v(r,i,t),{key:r,modifiers:i,action:t}}function b(e,t,n,r,o){A[e+":"+n]=t,e=e.replace(/\s+/g," ");var i,a=e.split(" ");return a.length>1?void k(e,a,t,n):(i=w(e,n),N[i.key]=N[i.key]||[],c(i.key,i.modifiers,{type:i.action},r,e,o),void N[i.key][r?"unshift":"push"]({callback:t,modifiers:i.modifiers,action:i.action,seq:r,level:o,combo:e}))}function C(e,t,n){for(var r=0;r<e.length;++r)b(e[r],t,n)}for(var E,K,q={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},P={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},T={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},L={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},N={},A={},M={},S=!1,j=!1,x=!1,D=1;20>D;++D)q[111+D]="f"+D;for(D=0;9>=D;++D)q[D+96]=D;r(t,"keypress",p),r(t,"keydown",p),r(t,"keyup",p);var O={bind:function(e,t,n){return e=e instanceof Array?e:[e],C(e,t,n),this},unbind:function(e,t){return O.bind(e,function(){},t)},trigger:function(e,t){return A[e+":"+t]&&A[e+":"+t]({},e),this},reset:function(){return N={},A={},this},stopCallback:function(e,t){return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},handleKey:h};e.Mousetrap=O,"function"==typeof define&&define.amd&&define(O)}(window,document);